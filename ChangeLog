2007-12-12  Ludovic Courtès <ludo@gnu.org>

	* NEWS, README: Update stuff.

2007-12-12  Ludovic Courtès <ludo@gnu.org>

	* NEWS, doc/guile-reader.texi: doc: Add "Quick Start" section.  *
	doc/guile-reader.texi (Quick Start): New node.

2007-10-25  Ludovic Courtès <ludo@gnu.org>

	* Makefile.am, configure.ac, doc/Makefile.am, module/Makefile.am,
	module/system/documentation/c-snarf.scm,
	module/system/documentation/output.scm, module/system/reader.scm,
	module/system/reader/compat.scm,
	module/system/reader/confinement.scm,
	module/system/reader/library.scm, modules/Makefile.am,
	modules/system/documentation/c-snarf.scm,
	modules/system/documentation/output.scm, modules/system/reader.scm,
	modules/system/reader/compat.scm,
	modules/system/reader/confinement.scm,
	modules/system/reader/library.scm, pre-inst-guile.in: Rename
	`module' to `modules'.

2007-10-25  Ludovic Courtès <ludo@gnu.org>

	* doc/extract-c-doc.scm: Reinstate documentation of C functions.  *
	doc/extract-c-doc.scm (main): Set `*document-c-functions?*' to true.


2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* NEWS, TODO: Update `NEWS'.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* src/symbol-token-reader.c, src/token-readers.c: For long
	symbols/strings/numbers, concatenate strings at the end.  *
	src/symbol-token-reader.c (NUMBER_TR_NAME): Use
	`scm_string_concatenate ()' at the end instead of `scm_string_append
	()'   at every step, for obvious algorithmic reasons.
	(SYMBOL_TR_NAME): Likewise.  * src/token-readers.c
	(scm_read_string): Likewise.   (SYMBOL_BUFFER_SIZE): New.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* src/token-readers.c, tests/scheme-reader.scm: Fix `CHAR_IS_BLANK
	()'.  * src/token-readers.c (CHAR_IS_BLANK): Recognize `\r', `\f',
	and MSDOS'   26.  From Guile 1.8.3's reader.  *
	tests/scheme-reader.scm (test-cases)[symbols-with-cr]: New test.
	(scheme-reader): Leave with `(exit failed)', otherwise failures were
	invisible.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* src/Makefile.am, src/reader-lib.c, src/reader.c,
	src/token-readers.c: Don't use GNU Make extensions.  *
	src/Makefile.am (BUILT_SOURCES): Rename `*.c.x' to `*.x'.   (%.c.x):
	Changed to...   (.c.x): This rule.   (%.doc): Remove.  *
	src/reader-lib.c: Update.  * src/reader.c: Update.  *
	src/token-readers.c: Update.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* configure.ac, src/Makefile.am: Use GCC flags only when using GCC.
	* configure.ac (GCC_CFLAGS): New.
	(LIGHTNING_CONFIGURE_IF_NOT_FOUND): Change `GCC_CFLAGS' if lightning
	is available.  * src/Makefile.am (AM_CPPFLAGS): New.   (AM_CFLAGS):
	Use `$(GCC_CFLAGS)'.   (snarfcppopts): Use `$(AM_CPPFLAGS)', not
	`$(AM_CFLAGS)'.   (%.doc): Likewise.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* .arch-inventory, build-aux/.arch-inventory, doc/.arch-inventory: 
	Remove `.arch-inventory'.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* TODO: Update `TODO'.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* src/.gitignore: More `.gitignore'.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* Makefile.am, compat.h, configure.ac, doc/Makefile.am,
	example-repl.scm, extract-make-reader-flags.sh,
	extract-token-readers.sh, pre-inst-guile.in, reader-config.h.in,
	reader-lib.c, reader-lib.h, reader.c, reader.h, src/Makefile.am,
	src/compat.h, src/example-repl.scm,
	src/extract-make-reader-flags.sh, src/extract-token-readers.sh,
	src/reader-config.h.in, src/reader-lib.c, src/reader-lib.h,
	src/reader.c, src/reader.h, src/symbol-token-reader.c,
	src/token-readers.c, src/token-readers.h, symbol-token-reader.c,
	token-readers.c, token-readers.h: Add `src' sub-directory (!).

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* doc/Makefile.am, tests/Makefile.am: Make `distcheck' happy.  *
	doc/Makefile.am (AM_CPPFLAGS): New.   (*.texi): Use it.  *
	tests/Makefile.am (CLEANFILES): New.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* configure.ac: Bump version number.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* configure.ac, doc/Makefile.am, doc/extract-c-doc.scm,
	doc/extract-c-doc.scm.in, module/system/documentation/c-snarf.scm,
	module/system/documentation/output.scm: Update C doc snarfing tools
	(from Guile-Avahi).

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* .gitignore, doc/.gitignore: Add `.gitignore'.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* INSTALL: Update `INSTALL'.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* NEWS, configure.ac, module/Makefile.am,
	module/system/Makefile.am, module/system/documentation/Makefile.am,
	module/system/reader/Makefile.am: Add support for configure
	`--with-guilemoduledir'.

2007-10-24  Ludovic Courtès <ludo@gnu.org>

	* NEWS, README: Mention Git repository.

2007-02-24  Ludovic Courtes <ludovic.courtes@laas.fr>

	* : Releasing version 0.3.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--version-0

2007-02-22  Ludovic Courtes <ludovic.courtes@laas.fr>

	* doc/guile-reader.texi: More doc fixes.  * doc/guile-reader.texi:
	Fixed various cross-references and little   things.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-54

2007-02-20  Ludovic Courtes <ludovic.courtes@laas.fr>

	* : Fixed ChangeLog.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-53

2007-02-20  Ludovic Courtes <ludovic.courtes@laas.fr>

	* doc/guile-reader.texi: Minor documentation fixes.  *
	doc/guile-reader.texi: Fixed `@author'.   (Introduction): Changed
	`@inforef' into proper `@pxref' in the   introduction.  Mention
	Gambit.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-52

2007-02-20  Ludovic Courtes <ludovic.courtes@laas.fr>

	* doc/extract-doc.scm: Fixed token reader documentation extraction.
	* doc/extract-doc.scm (extract-token-reader-doc)[show-char-escaped]:
	Don't treat `\' specially.   Uncommented `@columnfractions'.
	Output a newline after each `@item'.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-51

2007-02-20  Ludovic Courtes <ludovic.courtes@laas.fr>

	* .arch-inventory, build-aux/.arch-inventory, configure.ac,
	doc/.arch-inventory: Arch inventory cleanup.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-50

2007-02-20  Ludovic Courtes <ludovic.courtes@laas.fr>

	* NEWS, README, doc/guile-reader.texi: Documentation improvements.
	* README: Updated.  * doc/guile-reader.texi: Likewise.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-49

2007-02-20  Ludovic Courtes <ludovic.courtes@laas.fr>

	* doc/Makefile.am, module/system/documentation/output.scm: Improved
	the output of snarfed doc.  * doc/Makefile.am (CLEANFILES): New
	variable.  * module/system/documentation/output.scm: Use `srfi-1'.
	(scheme-procedure-texi-line): New.  Properly render optional and
	rest   arguments.   (procedure-gdf-string): Use it.
	(procedure-texi-documentation): Likewise.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-48

2007-02-20  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.c, token-readers.c: Updated copyright years.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-47

2007-02-18  Ludovic Courtes <ludovic.courtes@laas.fr>

	* token-readers.c: Fixed warnings in `token-readers.c'.  *
	token-readers.c (scm_read_sexp): Removed unused variables.  Replaced
	`#if SCM_ENABLE_ELISP' by `#if 0'.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-46

2007-02-18  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.c: `scm_c_make_reader'/lightning: Use `JIT_V2' for the
	top-level reader.  * reader.c: lightning part: Use `JIT_V2' to store
	the top-level reader.   (stack_offsets_t)[top_level_reader]:
	Removed.   (generate_reader_prologue): Updated.
	(generate_token_reader_invocation): Likewise.   (scm_c_make_reader):
	Likewise.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-45

2006-11-21  Ludovic Courtes <ludovic.courtes@laas.fr>

	* Makefile.am: Fixed LDFLAGS for `libguile-reader.la'.  *
	Makefile.am (libguile_reader_la_LDFLAGS): Added `$(GUILE_LDFLAGS)'.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-44

2006-11-21  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.c: scm_c_make_reader/lightning: Migrate from `pushr' to
	`allocai'.  * reader.c (stack_offsets_t): New.
	(compilation_context_t): New.   (JIT_STACK_LOCAL_VARIABLES_SIZE):
	Removed.   (generate_debug_registers): Take a single CONTEXT arg
	instead of START   and BUFFER_SIZE.  Use CONTEXT->OFFSETS.TEMP[1-4]
	and store data there   instead of using `jit_pushr'.
	(generate_position_store): Likewise.   (generate_position_set):
	Likewise.   (generate_to_upper): Likewise.   (generate_to_lower):
	Likewise.   (generate_getc_update_port_position): Likewise.
	(generate_getc): Likewise.   (generate_space_reservation): Likewise.
	(generate_abortion): Likewise.   (generate_character_dispatch):
	Likewise.   (generate_token_reader_invocation): Likewise.
	(generate_unexpected_character_handling): Likewise.
	(generate_character_handling_code): Likewise.   (scm_c_make_reader):
	Updated.   (generate_reader_prologue): Initialize the
	CONTEXT->OFFSETS.   (generate_reader_epilogue): Don't touch
	`JIT_SP'.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-43

2006-11-01  Ludovic Court`es <ludovic.courtes@laas.fr>

	* doc/Makefile.am, doc/extract-doc.scm, doc/guile-reader.texi,
	module/system/reader/library.scm, reader-lib.c, reader.c, reader.h,
	tests/scheme-reader.scm: Updated documentation wrt. to
	`%reader-standard-fault-handler'.  * doc/Makefile.am
	(make-reader-doc.texi): Include doc for
	`%reader-standard-fault-handler'.  * doc/extract-doc.scm
	(extract-module-doc): Don't issue anything for   undocumented
	procedures.  * doc/guile-reader.texi (Defining a New Reader): Fixed
	a typo.  * module/system/reader/library.scm
	(make-alternate-guile-reader): Have   FAULT-HANDLER to
	`%reader-standard-fault-handler'; document it.  * reader-lib.c
	(make-guile-reader): Likewise.  * reader.c (make-reader): Document
	FAULT-HANDLER.   (scm_reader_standard_fault_handler): Use
	`SCM_DEFINE'.   (scm_reader_init_bindings): Updated accordingly.  *
	reader.h (scm_reader_standard_fault_handler): New declaration.  *
	tests/scheme-reader.scm (test-cases): Removed outdated `FIXME'.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-42

2006-11-01  Ludovic Court`es <ludovic.courtes@laas.fr>

	* reader.c: make-reader/lightning: Use `jit_retval' instead of
	accessing `JIT_RET'.  * reader.c: In all lightning code-generation
	functions, use `jit_retval'   to fetch the return value instead of
	accessing `JIT_RET' (which doesn't   work on SPARC).
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-41

2006-10-31  Ludovic Court`es <ludovic.courtes@laas.fr>

	* reader-lib.c, reader.c: Tiny fixes for the debug mode (with the
	`DEBUG' macro defined).  * reader-lib.c (SHARP_READER_SIZE): Bumped
	to 20000.   (TOP_LEVEL_READER_SIZE): Bumped to 25000.  * reader.c
	(do_scm_set_source_position): Fixed the arguments passed to   `debug
	()'.   (generate_character_handling_code): Added a `debug ()'
	statement   showing the value of HANDLER_CODE.   (test_getc): Added
	missing argument to `generate_getc ()'.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-40

2006-10-28  Ludovic Court`es <ludovic.courtes@laas.fr>

	* reader-lib.c: Fixed a bug in `make-guile-reader' when
	FAULT_HANDLER is not `#f'.  * reader-lib.c (scm_make_guile_reader):
	When FAULT_HANDLER is not `#f',   terminate S_DEPS with `#f'.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-39

2006-10-25  Ludovic Courtes <ludovic.courtes@laas.fr>

	* doc/Makefile.am, doc/guile-reader.texi, token-readers.h: Doc:
	Improved, started and populated the ``Limitations'' section.  *
	doc/Makefile.am (BUILT_SOURCES): Removed `reader-lib-api-doc.texi',
	added `default-reader-doc.texi' and `make-guile-reader-doc.texi'.
	(reader-lib-api-doc.texi): Target removed.
	(default-reader-doc.texi): New target.
	(make-guile-reader-doc.texi): New target.  * doc/guile-reader.texi
	(Introduction): Improved.   (Limitations): New section.   (Token
	Delimiters): Moved therein.   (Overlapping Token Readers): New
	section.   (Compatibility and Confinement): Fixed references to
	Guile 1.7, added a   cross-reference to Guile's manual.
	(Internals): Mention the performance of automatically generated
	scanners.  * token-readers.h: Added cross-references to ``Token
	Delimiters'' and   ``Overlapping Token Readers''.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-38

2006-10-24  Ludovic Courtes <ludovic.courtes@laas.fr>

	* doc/guile-reader.texi, reader.c: Slight documentation
	improvements.  * doc/guile-reader.texi (Introduction): Mention SILex
	and the limitations   of guile-reader.   (Token Delimiters): Mention
	SILex.  * reader.c (scm_make_reader): Added a complete docstring.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-37

2006-10-24  Ludovic Courtes <ludovic.courtes@laas.fr>

	* doc/extract-c-doc.scm.in: extract-c-doc.scm.in: Fixed `-I' flags.
	* doc/extract-c-doc.scm.in: Also pass `-I@top_builddir@'.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-36

2006-10-24  Ludovic Courtes <ludovic.courtes@laas.fr>

	* doc/.arch-inventory, doc/Makefile.am, doc/guile-reader.texi: Use
	the new C doc snarfing tools in `guile-reader.texi'.  *
	doc/.arch-inventory: Updated the list of precious things.  *
	doc/Makefile.am (BUILT_SOURCES): Added a few files.
	(make-token-reader-doc.texi): New target.
	(token-reader-api-doc.texi): New target.   (make-reader-doc.texi):
	New target.   (reader-lib-api-doc.texi): New target.  *
	doc/guile-reader.texi: Include all those files.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-35

2006-10-24  Ludovic Courtes <ludovic.courtes@laas.fr>

	* doc/extract-c-doc.scm.in: Tiny fix for `extract-c-doc.scm.in'.  *
	doc/extract-c-doc.scm.in (main): Fixed handling of the PROCS rest
	argument.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-34

2006-10-24  Ludovic Courtes <ludovic.courtes@laas.fr>

	* Makefile.am: Tiny fix for the top-level Makefile.am.  *
	Makefile.am (EXTRA_DIST): Added `pre-inst-guile.in'.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-33

2006-10-24  Ludovic Courtes <ludovic.courtes@laas.fr>

	* configure.ac, doc/.arch-inventory, doc/Makefile.am,
	doc/extract-c-doc.scm.in, module/system/Makefile.am,
	module/system/documentation/Makefile.am,
	module/system/documentation/c-snarf.scm,
	module/system/documentation/output.scm: Added the basic
	infrastructure for C doc snarffing.  * configure.ac: Output
	`module/system/documentation/Makefile' and
	`doc/extract-c-doc.scm'; make `doc/extract-c-doc.scm' executable.  *
	doc/.arch-inventory: Account for `extract-c-doc.scm'.  *
	doc/Makefile.am (EXTRA_DIST): Added `extract-c-doc.scm.in'.  *
	module/system/Makefile.am (SUBDIRS): Added `documentation'.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-32

2006-10-24  Ludovic Courtes <ludovic.courtes@laas.fr>

	* : Added missing patch logs.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-31

2006-08-23  Ludovic Court`es <ludovic.courtes@laas.fr>

	Fixed build procedure, thereby allowing for `distcheck'.  *
	Makefile.am (AM_CFLAGS): Added `top_srcdir' and `top_builddir'.
	(snarfcppopts): Added `$(AM_CFLAGS)'.   (*.c): Prepended
	`$(top_srcdir)' to the dependency file names.  * doc/Makefile.am
	(token-reader-doc.texi): Get `pre-inst-guile' from   `top_builddir'
	rather than `top_srcdir'.  * extract-make-reader-flags.sh: Read from
	stdin rather than cat'ting   `reader.h'.  *
	extract-token-readers.sh: Likewise.  * pre-inst-guile.in: Get
	`libtool' from `builddir' rather than `srcdir'.  * tests/Makefile.am
	(TESTS_ENVIRONMENT): Export `top_builddir'.  * tests/benchmark.scm:
	Get `pre-inst-guile' from `builddir'.  * tests/confinement.scm:
	Likewise.  * tests/library.scm: Likewise.  * tests/position.scm:
	Likewise.  * tests/scheme-reader.scm: Likewise.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-30

2006-07-17  Ludovic Courtes <ludovic.courtes@laas.fr>

	* configure.ac, reader.c: Use a jump table to dispatch character
	handling in the Lightning-based version.  * configure.ac: Check the
	size of `void *'.  * reader.c (guile_reader_abort): New.
	(generate_getc): Take an additional DEBUG argument.  Generate
	appropriate code if true.   (generate_space_reservation): New.
	Taken from
	`lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-2'.
	(generate_abortion): New.   (generate_character_dispatch): New.
	(populate_jump_table_for_tr): New.
	(generate_character_handling_code): New.   (scm_c_make_reader): Use
	`generate_space_reservation ()',   `generate_character_dispatch ()'
	and `generate_character_handling_code ()'.    Note: The jump table
	provides almost invisible improvement (per   `benchmark.scm') on x86
	at least.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-29

2006-07-17  Ludovic Courtes <ludovic.courtes@laas.fr>

	* tests/benchmark.scm: Tweaked the benchmark.  * tests/benchmark.scm
	(%iterations): Set to 50 (was 30).   (how-long): Use `(tms:utime
	(times))' instead of `get-internal-run-time'.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-28

2006-07-16  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.c: Honor the `lightning_state' argument in all `generate_'
	procedures.  * reader.c (generate_token_reader_invocation): Define
	`_jit'.   (generate_unexpected_character_handling): Likewise.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-27

2006-07-16  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.c: scm_c_make_reader/Lightning: More on factorization.  *
	reader.c (scm_c_make_reader): Moved position-setting code to...
	(generate_token_reader_invocation): Here.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-26

2006-07-16  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.c: scm_c_make_reader/Lightning: Factorized out token reader
	invocation.  * reader.c (generate_token_reader_invocation): New,
	stolen from   `scm_c_make_reader ()'.   (scm_c_make_reader): Moved
	reader invocation code there.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-25

2006-07-14  Ludovic Courtes <ludovic.courtes@laas.fr>

	* tests/Makefile.am, tests/library.scm: Added test cases for
	`make-alternate-guile-reader'.  * tests/Makefile.am (TESTS): Added
	`library.scm'.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-24

2006-07-14  Ludovic Courtes <ludovic.courtes@laas.fr>

	* module/system/reader/library.scm: Fixed
	`make-alternate-guile-reader' for `colon-keywords'.  *
	module/system/reader/library.scm (filter-out-symbol-token-readers):
	Fixed (was using `eq?' to compare lists).
	(ensure-colon-free-token-readers): New.
	(alternate-guile-reader-token-readers): In the `colon-keywords'
	case,   use `ensure-colon-free-token-readers'.  In the
	`case-insensitive' case,   use `memq' instead of `member'.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-23

2006-07-14  Ludovic Courtes <ludovic.courtes@laas.fr>

	* module/system/reader.scm, reader.c: Implemented O(1) char lookup
	for the Lightning-less version.  * module/system/reader.scm
	(token-reader-handles-char?): New exported   procedure.  * reader.c
	(tr_handles_char): Moved higher in the file, out of the   `#ifdef'.
	(struct scm_reader)[eightbit_char_to_tr_map]: New field (in the case
	where Lighting is not used).   (scm_c_make_reader): Initialize it.
	(scm_call_reader): Use the 8-bit-char-to-token-reader map for faster
	lookup.  This makes `guile-reader' (without Lightning) 7.3 times
	faster   than Guile's built-in reader (was 6.4 times faster without
	this).   (scm_token_reader_handles_char_p): New.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-22

2006-07-14  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader-lib.c, token-readers.h: Fixed handling of `#f' between the
	`srfi-4' and `boolean' token readers.  * token-readers.h
	(SCM_TR_SRFI_4): Documented the handling of `#f'.
	(SCM_TR_BOOLEAN_SRFI_4): New.  Likewise.  * reader-lib.c
	(scm_sharp_reader_standard_specs): Use   `SCM_TR_BOOLEAN_SRFI_4'
	instead of `SCM_TR_BOOLEAN'.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-21

2006-07-14  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.c: Fixed the Lightning-free implementation (did not
	compile).  * reader.c (do_scm_set_source_position): Fixed the
	`debug' statement.   (scm_call_reader): Don't use `scm_port_column
	()', `scm_port_line ()',   et al; use the `SCM_COL ()', `SCM_LINUM
	()', etc. macros instead.   (scm_to_make_reader_flags): Removed
	unused variable C_FLAG.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-20

2006-07-11  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.c: Optimized source-position recording in the Lightning
	version.  * reader.c (do_scm_set_source_position): Take LINE as a
	`long' and COLUMN   as an `int' instead of `SCM's.
	(SCM_JIT_PTAB_ENTRY): New.  Similar to the former `FETCH_C_PORT ()'
	macro used in `generate_getc ()'.   (generate_position_store):
	Directly access the fields of the C port   structure instead of
	invoking `scm_port_line ()', `scm_port_column ()'   and
	`scm_port_filename ()'.   (generate_getc)[FETCH_C_PORT]: Removed.
	Use `SCM_JIT_PTAB_ENTRY ()'   instead.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-19

2006-07-11  Ludovic Courtes <ludovic.courtes@laas.fr>

	* tests/benchmark.scm: Benchmark: Test with and without position
	recording.  * tests/benchmark.scm (compare-readers): New.
	(benchmark): Use it, passing it readers with and without position
	recording.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-18

2006-07-07  Ludovic Court`es <ludovic.courtes@laas.fr>

	* doc/.arch-inventory, doc/Makefile.am, doc/guile-reader.texi,
	reader.h, tests/Makefile.am: Fixed version handling in the manual.
	Bumped version to 0.3.  * doc/Makefile.am (BUILT_SOURCES): Added
	`version.texi'.  * doc/guile-reader.texi: Include `version.texi'.  *
	reader.h (SCM_READER_VERSION_MINOR): Set to 3.  * tests/Makefile.am
	(dist_check_SCRIPTS): Removed.  Use `EXTRA_DIST'   instead (undoes
	previous patch).  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-17

2006-07-07  Ludovic Court`es <ludovic.courtes@laas.fr>

	* .arch-inventory, configure.ac, doc/Makefile.am,
	doc/extract-doc.scm, pre-inst-guile.in, tests/.arch-inventory,
	tests/Makefile.am, tests/benchmark.scm, tests/confinement.scm,
	tests/guile-for-test.in, tests/position.scm,
	tests/scheme-reader.scm: Various cleanups for the configure and
	build stages.  * configure.ac: Test the value of `$GPERF', not that
	of `$gperf'.   (AC_CONFIG_FILES): Added `pre-inst-guile', removed
	`tests/guile-for-test'.   (AC_CONFIG_COMMANDS): Likewise.  *
	doc/Makefile.am (reader-lib-doc.texi): New target.  Make sure to use
	`$(top_srcdir)/pre-inst-guile' when running `extract-doc.scm'.  *
	doc/extract-doc.scm: Removed initial shell meta-stuff.  *
	tests/Makefile.am: Use `dist_check_SCRIPTS' rather than
	`EXTRA_DIST'.   (TEST_ENVIRONMENTS): New.  * tests/benchmark.scm:
	Use `$top_srcdir' when defined.  * tests/confinement.scm: Likewise.
	* tests/position.scm: Likewise.  * tests/scheme-reader.scm:
	Likewise.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-16

2006-07-06  Ludovic Court`es <ludovic.courtes@laas.fr>

	* reader.c: Inlined `scm_getc ()': Work around Lightning bug on
	PowerPC.  * reader.c (generate_getc_update_port_position): Use
	`andi(r1, r2, 7)'   rather than `modi(r1, r2, 8)' in the `\t' case.
	This works around a   Lightning bug on PowerPC (where `modi' seems
	broken), plus it may yield   more efficient code on all
	architectures (e.g., PPC doesn't have a   `modi' instruction, so
	using it yields a long sequence of instructions).
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-15

2006-07-06  Ludovic Court`es <ludovic.courtes@laas.fr>

	Merge from guile-reader@sv.gnu.org  Patches applied:   *
	guile-reader@sv.gnu.org/guile-reader--devo--0.3  (patch 8-14)     -
	Merge: Adapted to use `scm_c_locale_stringn_to_number ()' where
	available.    - First stab at the implementation of an inlined
	`scm_getc ()'.    - Finished the inline JIT implementation of
	`scm_getc ()'.    - Improved the position-recording test case.    -
	Re-organized and cleaned up the test framework.    - Added a tiny
	benchmark.    - Fixed `guile-for-test' so that the right shared
	library is used.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.3  (patch 9-14)
	- First stab at the implementation of an inlined `scm_getc ()'.    -
	Finished the inline JIT implementation of `scm_getc ()'.    -
	Improved the position-recording test case.    - Re-organized and
	cleaned up the test framework.    - Added a tiny benchmark.    -
	Fixed `guile-for-test' so that the right shared library is used.
	git-archimport-id:
	lcourtes@laas.fr--2005-libre/guile-reader--devo--0.3--patch-9

2006-07-05  Ludovic Courtes <ludovic.courtes@laas.fr>

	* tests/guile-for-test.in: Fixed `guile-for-test' so that the right
	shared library is used.  * tests/guile-for-test.in: Use Libtool
	magic to make sure the right   `libguile-reader.so' is used.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-14

2006-07-05  Ludovic Courtes <ludovic.courtes@laas.fr>

	* tests/Makefile.am, tests/benchmark.scm: Added a tiny benchmark.  *
	tests/Makefile.am (EXTRA_DIST): Added `benchmark.scm'.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-13

2006-07-05  Ludovic Courtes <ludovic.courtes@laas.fr>

	* Makefile.am, configure.ac, guile.c, test-confinement.scm,
	test-position.scm, tests/.arch-inventory, tests/Makefile.am,
	tests/confinement.scm, tests/guile-for-test.in, tests/position.scm,
	tests/scheme-reader.scm, testsuite.scm: Re-organized and cleaned up
	the test framework.  * tests/guile-for-test.in: New.  * Makefile.am
	(noinst_PROGRAMS): Removed.   (guile_LDFLAGS): Removed.   (TESTS):
	Removed.   (SUBDIRS): Added `tests'.  * configure.ac: Issue
	`tests/guile-for-test' and make it executable.   Bumped version
	number to `0.3'.  * tests/confinement.scm: Use `./guile-for-test' by
	default and don't pass   it `-L module'.  * tests/position.scm:
	Likewise.  * tests/scheme-reader.scm: Likewise.  Renamed the module
	from `testsuite'   to `scheme-reader'.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-12

2006-07-05  Ludovic Courtes <ludovic.courtes@laas.fr>

	* test-position.scm: Improved the position-recording test case.  *
	test-position.scm (%test-cases): Added test cases with `\a', `\b',
	`\r'.  Useful to test the inline `scm_getc ()' implementation.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-11

2006-07-05  Ludovic Courtes <ludovic.courtes@laas.fr>

	* NEWS, reader.c: Finished the inline JIT implementation of
	`scm_getc ()'.  * reader.c: Updated copyright years.
	(SCM_READER_INLINE_GETC): Now defined by default.
	(generate_getc_update_port_position): New.   (generate_getc): Use
	it.  * NEWS: Updated.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-10

2006-07-02  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.c: First stab at the implementation of an inlined `scm_getc
	()'.  * reader.c (generate_getc): New.  Lacks code to update
	column/line   numbers.   (generate_reader_prologue): Move some of
	the initialization stuff from   `scm_c_make_reader ()' here.
	(scm_c_make_reader): See above.  Adjusted to use `generate_getc ()'
	if   `SCM_READER_INLINE_GETC' is defined.   (test_getc): New.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-9

2006-03-21  Ludovic Court`es <ludovic.courtes@laas.fr>

	Merge: Adapted to use `scm_c_locale_stringn_to_number ()' where
	available.  * compat.h: New file.  * Makefile.am (EXTRA_DIST): Added
	`compat.h'.  * configure.ac: Check for
	`scm_c_locale_stringn_to_number ()' and   `scm_i_mem2number ()'.  *
	symbol-token-reader.c: Include `compat.h'.  Use
	`scm_c_locale_stringn_to_number ()' instead of `scm_i_mem2number
	()'.  * token-readers.c: Likewise.   git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-8

2006-03-21  Ludovic Court`es <ludovic.courtes@laas.fr>

	Merge from guile-reader@sv.gnu.org  Patches applied:   *
	guile-reader@sv.gnu.org/guile-reader--devo--0.3  (patch 7)  *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.3  (patch 7)
	- Fixed C99ism in the `SCM_DEFTOKEN' macros.  git-archimport-id:
	lcourtes@laas.fr--2005-libre/guile-reader--devo--0.3--patch-8

2006-03-21  Ludovic Court`es <ludovic.courtes@laas.fr>

	* Makefile.am, compat.h, configure.ac, symbol-token-reader.c,
	token-readers.c: Adapted to use `scm_c_locale_stringn_to_number ()'
	where available.  * compat.h: New file.  * Makefile.am (EXTRA_DIST):
	Added `compat.h'.  * configure.ac: Check for
	`scm_c_locale_stringn_to_number ()' and   `scm_i_mem2number ()'.  *
	symbol-token-reader.c: Include `compat.h'.  Use
	`scm_c_locale_stringn_to_number ()' instead of `scm_i_mem2number
	()'.  * token-readers.c: Likewise.  git-archimport-id:
	lcourtes@laas.fr--2005-libre/guile-reader--devo--0.3--patch-7

2006-03-19  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.h: Fixed C99ism in the `SCM_DEFTOKEN' macros.  * reader.h
	(SCM_DEFTOKEN_SINGLE): Made more C89-friendly (assignment of
	`.value.c_reader').   (SCM_DEFTOKEN_RANGE): Likewise.
	(SCM_DEFTOKEN_SET): Likewise.   (SCM_END_TOKENS): Likewise.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-7

2006-01-25  Ludovic Court`es <ludovic.courtes@laas.fr>

	Merge from guile-reader@sv.gnu.org  Patches applied:   *
	guile-reader@sv.gnu.org/guile-reader--devo--0.3  (patch 5-6)     -
	Moved `current-reader' and `primitive-load' to `compat.scm'.    -
	Fixed a bug in position recording; added a corresponding test case.
	* lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.3  (patch 5-6)
	- Merge from guile-reader@sv.gnu.org    - Fixed a bug in position
	recording; added a corresponding test case.  git-archimport-id:
	lcourtes@laas.fr--2005-libre/guile-reader--devo--0.3--patch-6

2006-01-24  Ludovic Courtes <ludovic.courtes@laas.fr>

	* Makefile.am, reader.c, test-position.scm: Fixed a bug in position
	recording; added a corresponding test case.  Patches applied:   *
	guile-reader--devo--0.3  (patch 5-6)     - Merge from
	guile-reader@sv.gnu.org    - Fixed a bug in position recording;
	added a corresponding test case.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-6

2006-01-11  Ludovic Court`es <ludovic.courtes@laas.fr>

	Moved `current-reader' and `primitive-load' to `compat.scm'.  *
	module/system/reader/confinement.scm: Moved `current-reader' and
	`primitive-load' out of here.  * module/system/reader/compat.scm:
	New home of the `current-reader' and   `primitive-load'
	forward-compatible implementations.  * doc/guile-reader.texi
	(Compatibility and Confinement): Updated   according to the new
	definition of `current-reader'.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-5

2006-01-11  Ludovic Court`es <ludovic.courtes@laas.fr>

	* doc/guile-reader.texi, module/system/reader/compat.scm,
	module/system/reader/confinement.scm: Moved `current-reader' and
	`primitive-load' to `compat.scm'.  *
	module/system/reader/confinement.scm: Moved `current-reader' and
	`primitive-load' out of here.  * module/system/reader/compat.scm:
	New home of the `current-reader' and   `primitive-load'
	forward-compatible implementations.  * doc/guile-reader.texi
	(Compatibility and Confinement): Updated   according to the new
	definition of `current-reader'.  git-archimport-id:
	lcourtes@laas.fr--2005-libre/guile-reader--devo--0.3--patch-5

2006-01-11  Ludovic Court`es <ludovic.courtes@laas.fr>

	* module/system/reader/confinement.scm: Made compatible with the new
	(CVS) definition of `current-reader'.  *
	module/system/reader/confinement.scm: Made compatible with the
	now-in-CVS definition of `current-reader' as a fluid.
	git-archimport-id:
	lcourtes@laas.fr--2005-libre/guile-reader--devo--0.3--patch-4

2006-01-11  Ludovic Court`es <ludovic.courtes@laas.fr>

	Merge from guile-reader@sv.gnu.org  Patches applied:   *
	guile-reader@sv.gnu.org/guile-reader--devo--0.3  (patch 4)  *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.3  (patch 4)
	- Made `scm_read_keyword ()' more robust.  git-archimport-id:
	lcourtes@laas.fr--2005-libre/guile-reader--devo--0.3--patch-3

2006-01-10  Ludovic Courtes <ludovic.courtes@laas.fr>

	* token-readers.c: Made `scm_read_keyword ()' more robust.  *
	token-readers.c (scm_read_keyword): Before calling
	`scm_symbol_to_keyword ()', make sure we actually read a keyword.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-4

2006-01-10  Ludovic Court`es <ludovic.courtes@laas.fr>

	Merge from guile-reader@sv.gnu.org  Patches applied:   *
	guile-reader@sv.gnu.org/guile-reader--devo--0.3  (base, patch 1-3)
	- tag of
	lcourtes@laas.fr--2005-libre/guile-reader--devo--0.3--base-0    -
	Avoid using Scheme strings as intermediate representations.    -
	Fixed a bug in source position recording for non-file ports.    -
	Rewrote and optimized `scm_read_string ()'.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.3  (patch 1, 3)
	- Fixed a bug in source position recording for non-file ports.    -
	Rewrote and optimized `scm_read_string ()'.  git-archimport-id:
	lcourtes@laas.fr--2005-libre/guile-reader--devo--0.3--patch-2

2006-01-09  Ludovic Courtes <ludovic.courtes@laas.fr>

	* token-readers.c: Rewrote and optimized `scm_read_string ()'.  *
	token-readers.c (scm_read_string): Rewritten without using any Guile
	internal.  Hopefully, this is also more efficient in the common
	case.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-3

2006-01-09  Ludovic Courtes <ludovic.courtes@laas.fr>

	* reader.c: Fixed a bug in source position recording for non-file
	ports.  Patches applied:   * guile-reader--devo--0.3  (patch 1)
	- Fixed a bug in source position recording for non-file ports.
	git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-2

2005-12-16  Ludovic Court`es <ludovic.courtes@laas.fr>

	Avoid using Scheme strings as intermediate representations.  *
	symbol-token-reader.c (NUMBER_TR_NAME): Use Scheme strings only as a
	last resort, i.e., when the whole number doesn't fit in C_NUM.  Use
	`scm_i_mem2number ()' and `scm_from_locale_symboln ()' where
	possible.   The latter proves to be efficient when
	`scm_from_locale_symboln ()' is   not implemented using Scheme
	strings.   (SYMBOL_TR_NAME): Likewise.  git-archimport-id:
	guile-reader@sv.gnu.org/guile-reader--devo--0.3--patch-1

2005-12-16  Ludovic Court`es <ludovic.courtes@laas.fr>

	* symbol-token-reader.c: Avoid using Scheme strings as intermediate
	representations.  * symbol-token-reader.c (NUMBER_TR_NAME): Use
	Scheme strings only as a   last resort, i.e., when the whole number
	doesn't fit in C_NUM.  Use   `scm_i_mem2number ()' and
	`scm_from_locale_symboln ()' where possible.   The latter proves to
	be efficient when `scm_from_locale_symboln ()' is   not implemented
	using Scheme strings.   (SYMBOL_TR_NAME): Likewise.
	git-archimport-id:
	lcourtes@laas.fr--2005-libre/guile-reader--devo--0.3--patch-1

2005-11-24  Ludovic Court`es <ludovic.courtes@laas.fr>

	* Makefile.am, README, TODO, doc/guile-reader.texi,
	example-repl.scm, module/system/reader/confinement.scm,
	test-confinement.scm, test-repl.scm: Got ready for release 0.2.  *
	test-repl.scm: Renamed to `example-repl.scm'.  *
	test-confinement.scm: New file.  * ChangeLog: Changed the branch
	name to the right one.  * Makefile.am (TESTS): Added
	`test-confinement.scm'.   (EXTRA_DIST): Added `example-repl.scm'.  *
	README: Added the URL of the Savannah project and of the GNU Arch
	archives.  * TODO: Removed useless items.  * doc/guile-reader.texi
	(Compatibility and Confinement): Mention   `current-reader' and the
	`primitive-load' hack.   (Internals): Documented statically
	initialized token reader arrays.  *
	module/system/reader/confinement.scm (compile-module-read-options!):
	Use `ensure-reader-hash-extensions' instead of
	`%module-reader-hash-extensions'.  This fixes a bug when there are
	no   hash extensions.   (read-options-interface): Call
	`set-current-reader' when we're done.   (read-hash-extend):
	Likewise.   (primitive-load): New procedure.  git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-12

2005-11-23  Ludovic Court`es <ludovic.courtes@laas.fr>

	* NEWS, doc/extract-doc.scm, doc/guile-reader.texi,
	module/system/reader/confinement.scm,
	module/system/reader/library.scm, test-repl.scm, testsuite.scm,
	token-readers.h: Documented the reader confinement module, augmented
	the test suite.  Patches applied:   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-20
	Completed and documented the reader confinement module.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-21
	Fixed `misc-chars' symbol TRs; augmented the test suite.
	git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-11

2005-11-07  Ludovic Court`es <ludovic.courtes@laas.fr>

	* module/system/reader/Makefile.am,
	module/system/reader/compat.scm,
	module/system/reader/confinement.scm,
	module/system/reader/library.scm: Added a new `compat' module.
	Patches applied:   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-19
	Added a new `compat' module.   git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-10

2005-11-02  Ludovic Court`es <ludovic.courtes@laas.fr>

	* Makefile.am, TODO, configure.ac, doc/Makefile.am,
	doc/extract-doc.scm, doc/guile-reader.texi,
	extract-make-reader-flags.sh, module/system/reader.scm,
	module/system/reader/library.scm, reader-lib.h, reader.c, reader.h,
	test-repl.scm, testsuite.scm, token-readers.c, token-readers.h: 
	Improved the high-level API and the doc; implemented SRFI-30 and
	SRFI-62.  Patches applied:   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-15
	Fixed a bug of `scm_c_make_reader ()' (showing on PPC).   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-16
	Implemented `make-alternate-guile-reader'; augmented the doc.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-17
	Implemented SRFI-30 and SRFI-62 token readers.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-18
	Fixed the S-exp/Sk-exp TRs; fixed the build process.
	git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-9

2005-10-28  Ludovic Court`es <ludovic.courtes@laas.fr>

	* reader-lib.c, reader.c, reader.h, test-repl.scm, token-readers.c: 
	Fixed a bug of `scm_c_make_reader ()' (showing on PPC).  *
	reader-lib.c (SHARP_READER_SIZE): New.   (TOP_LEVEL_READER_SIZE):
	New.   (scm_default_reader): Use the above macros.  * reader.c
	(do_debug_regs): Added V1.   (generate_debug_registers): Push V1
	too.   (scm_c_make_reader): Call `jit_prolog (3)' instead of
	`jit_prolog   (2)'.  This fixes a bug at least on PPC.   Call
	`CHECK_CODE_SIZE' after each `debug_pre_call ()'.  * token-reader.c
	(_flush_ws): Return 0 by default.  * test-repl.scm: Minor change.
	git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-8

2005-10-28  Ludovic Court`es <ludovic.courtes@laas.fr>

	* Makefile.am, configure.ac, doc/extract-doc.scm,
	doc/guile-reader.texi, module/system/Makefile.am,
	module/system/reader/Makefile.am, module/system/reader/library.scm,
	reader-lib.c, reader-lib.h, reader.h, symbol-token-reader.c,
	testsuite.scm, token-readers.c, token-readers.h: Fixed the number
	TRs; implemented new TRs; implemented `make-guile-reader'.  Patches
	applied:   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-13
	Implemented `make-guile-reader' and the `guile-bit-vector' TR.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-14
	Fixed the number token readers.   git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-7

2005-10-24  Ludovic Court`es <ludovic.courtes@laas.fr>

	* Makefile.am, doc/Makefile.am, doc/extract-doc.scm,
	doc/guile-reader.texi, extract-token-readers.sh,
	module/system/reader.scm, reader-lib.c, reader-lib.h, reader.c,
	reader.h, test-repl.scm, token-readers.c, token-readers.h: 
	Implemented O(1) TR lookup and online documentation.  Patches
	applied:   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-12
	Implemented O(1) TR lookup and online documentation.
	git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-6

2005-10-17  Ludovic Court`es <ludovic.courtes@laas.fr>

	* Makefile.am, doc/guile-reader.texi, module/system/reader.scm,
	module/system/reader/confinement.scm, reader.c, reader.h,
	symbol-token-reader.c, test-repl.scm, testsuite.scm,
	token-readers.c, token-readers.h: New token readers, modified API,
	improved doc.  Patches applied:   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-8
	Fixed licensing issues.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-9
	Implemented upper-case/lower-case; started a `confinement' module.
	* lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-10
	Added a TOP_LEVEL_READER arg to both readers and TRs.  Implemented
	vectors.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-11
	Added a number of symbol and number token readers.
	git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-5

2005-10-14  Ludovic Court`es <ludovic.courtes@laas.fr>

	* Makefile.am, TODO, configure.ac, reader-config.h.in, reader.c,
	token-readers.c: Updated the Lightning-free version.  Patches
	applied:   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-7
	Updated the Lightning-free version.  Added a to-do list.
	git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-4

2005-10-13  Ludovic Court`es <ludovic.courtes@laas.fr>

	* COPYING, module/system/reader.scm, reader.c, reader.h,
	test-repl.scm, testsuite.scm, token-readers.c, token-readers.h: 
	Updated the license note to "GNU GPL v2 or later" everywhere.
	Updated the license note to "GNU GPL v2 or later" everywhere, plus
	FSF's postal mail address.  git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-3

2005-10-12  Ludovic Court`es <ludovic.courtes@laas.fr>

	* reader.c, reader.h, test-repl.scm, token-readers.c: Fixed a code
	generation bug; updated the API.  Patches applied:   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-5
	Fixed the reader prologue generation.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-6
	Cleaned the `make-reader' API, fixed a few bugs.
	git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-2

2005-10-10  Ludovic Court`es <ludovic.courtes@laas.fr>

	* Makefile.am, configure.ac, reader.c, reader.h, test-repl.scm,
	token-readers.c: Cleaned up `scm_c_make_reader ()' and implemented
	position recording.  Patches applied:   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--base-0    tag
	of lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-15
	* lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-1
	Started implementing position recording.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-2
	Working version of `scm_c_make_reader ()' that supports
	RECORD_POSITIONS.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-3
	Made `scm_c_make_reader ()' re-entrant, cleaned it a bit.   *
	lcourtes@laas.fr--2005-mobile/guile-reader--devo--0.2--patch-4
	Joined the branch for guile-reader 0.2 in the `2004-libre' archive.
	* lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-15
	Updated from the newly released 0.1.   git-archimport-id:
	lcourtes@laas.fr--2004-libre/guile-reader--devo--0.2--patch-1

2005-09-12  Ludovic Court`es <ludovic.courtes@laas.fr>

	* ChangeLog, Makefile.am, configure.ac, doc/guile-reader.texi,
	extract-token-readers.sh, reader.c, testsuite.scm: Got ready for
	release 0.1.  * Makefile.am (EXTRA_DIST):  Added $(TESTS).
	(%.doc):  New (unused) rule.  * configure.ac:  Look for
	`scm_take_u8vector' in order to make sure we're   using Guile 1.7.
	* doc/guile-reader.texi:  Significantly augmented.  *
	extract-token-readers.sh:  Handle the `--no-gperf-header' option
	(currently unused).  * reader.c (scm_c_make_reader):  When
	CALLER_HANDLED is a procedure,   don't use `jit_pusharg_p ((void
	*)start' (which is wrong), use   `jit_pusharg_p (JIT_R1)' instead.
	* testsuite.scm:  Use `(ice-9 format)'.  git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-12

2005-09-12  Ludovic Court`es <ludovic.courtes@laas.fr>

	* ChangeLog, Makefile.am, configure.ac, doc/Makefile.am,
	doc/guile-reader.texi, doc/texinfo.tex, guile.c,
	module/Makefile.am, module/system/Makefile.am,
	module/system/reader.scm, reader.c, reader.h, reader.scm,
	test-repl.scm, testsuite.scm, token-readers.c: GC and TR bug fixes;
	renamed module;  cleaned build process;  doc.  Patches applied:   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-10
	Fixed token readers for the remaining corner cases;  now reads
	`boot-9.scm'.   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-11
	Updated the Lightning-free implementation.   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-12
	Cleaned up the build and installation process.   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-13
	Fixed a GC bug;  renamed the reader module;  exported more C
	functions.   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-14
	Added a documentation skeleton.   git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-11

2005-09-07  Ludovic Court`es <ludovic.courtes@laas.fr>

	* ChangeLog, Makefile.am, reader.c, reader.h, test-repl.scm,
	testsuite.scm, token-readers.c, token-readers.h: New testsuite;  now
	able to define a fault handler, or to let the caller handle them.
	Patches applied:   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-6
	Added support for reader fault handlers;  wrote a test suite.   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-7
	Added the capability to escape to token readers.   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-8
	Allow for caller handling of a reader's unhandled characters.   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-9
	Added support for complex numbers, fixed a number of TRs.
	git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-10

2005-09-01  Ludovic Court`es <ludovic.courtes@laas.fr>

	* ChangeLog, INSTALL, Makefile.am, README, configure.ac,
	reader-config.h.in, reader.c, reader.h, test-repl.scm,
	token-readers.c, token-readers.h: Merge with laptop:  various bug
	fixes and an API improvement (still buggy).  Patches applied:   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--base-0
	tag of
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-2   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-1
	Merged with the main development branch.   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-2
	Optimized a bit the `token-reader-proc' case.   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-3
	Fixed two bugs that showed up when SCSH block comments were used.
	* lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-4
	Simplification of `scm_c_make_reader ()';  small bug fixes.   *
	lcourtes@laas.fr--2005-mobile/scheme-reader--devo--0.1--patch-5
	Various GC-related and other bug fixes.   git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-9

2005-08-26  Ludovic Court`es <ludovic.courtes@laas.fr>

	* ChangeLog, reader.c, reader.h: Added a SMOB type representing
	C-implemented token reader procedures.  * reader.c
	(token-reader-procedure):  Return a `token-reader-proc' SMOB   is
	reader is a C reader.   (scm_token_reader_proc_type):  New variable.
	(token_reader_proc_apply):  New proc.   (token_reader_proc_free):
	New proc.   (token_reader_proc_mark):  New proc.
	(scm_reader_init_bindings):  Init the new SMOB type.  * reader.h
	(scm_token_reader_proc_type):  New declaration.  git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-8

2005-08-24  Ludovic Court`es <ludovic.courtes@laas.fr>

	* ChangeLog, reader.c, reader.h, token-readers.c: Implemented and
	tested the Lightning-free version of `scm_c_make_reader ()'.  *
	reader.h (scm_call_reader):  New macro.  * reader.c
	(scm_call_reader):  New function.   (tr_handles_char):  New
	function.   (tr_invoke):  New function.  * token-readers.c:  Call
	readers using `scm_call_reader ()'.  git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-7

2005-08-24  Ludovic Court`es <ludovic.courtes@laas.fr>

	* ChangeLog, Makefile.am, reader.c, reader.scm, test-repl.scm,
	token-readers.c: Cleaned up the reader's code, augmented the API,
	fixed TR bugs.  * reader.c (read_token_spec):  Handle sets.
	(scm_make_token_reader):  Fixed a bug when a Scheme proc is passed.
	(token-reader-procedure):  New function.
	(token-reader-specification):  New function.   (token_reader_free):
	Free the set if it's a set.   (scm_to_reader_spec):  Removed.
	(read_token_reader_spec):  Removed.  * reader.scm:  Export the above
	new procedures.  * test-repl.scm (test-token-reader):  New variable.
	* token-readers.c (read_token):  Stop whenever a non-alphanumeric
	char is   read (like a bracket).   (scm_reader_standard_specs):
	Added `.' to `symbol-misc-chars';  this   fixes the sexp readers for
	pairs.  git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-6

2005-08-23  Ludovic Court`es <ludovic.courtes@laas.fr>

	* ChangeLog, reader.c, test-repl.scm, token-readers.c: Fixed and
	improved the token readers.  * reader.c (scm_c_make_reader):
	Produce code that returns `SCM_EOF_VAL'   when EOF is read.  *
	test-repl.scm:  Account for this.  * token-readers.c
	(scm_read_symbol):  Removed the size limitation;  call
	`scm_read_number ()' when reading a number.
	(scm_read_number_and_radix):  New function.   (scm_read_number):
	Removed the size limitation;  allow to read for   floating points,
	signed numbers, or symbols.  git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-5

2005-08-23  Ludovic Court`es <ludovic.courtes@laas.fr>

	* ChangeLog, Makefile.am, extract-token-readers.sh, reader.c,
	reader.h, reader.scm, test-repl.scm, token-readers.c,
	token-readers.h: Implemented first-class token readers.  *
	Makefile.am (lib_LTLIBRARIES):  Renamed the lib to
	`libguile-reader.la'.  * reader.c (scm_reader_smob_t):  New
	structure.   (SCM_NEW_READER_SMOB):  New macro.
	(SCM_READER_SMOB_DATA):  New macro.   (SCM_TOKEN_READER_SMOB_DATA):
	New macro.   (scm_c_make_reader):  Added calls to `CHECK_CODE_SIZE
	()'.   (scm_token_reader_lookup):  Moved to `token-readers.c'.
	(scm_from_reader):  New function.   (scm_from_token_reader):  New
	function.   (scm_to_reader):  New function.   (scm_make_reader):
	Changed.  Now expects a list of token reader SMOBs.
	(scm_make_token_reader):  New function.
	(scm_standard_token_reader):  New function.
	(scm_token_reader_type):  New variable.  * reader.h
	(scm_token_reader_type):  New declaration.  * reader.scm:  Export
	the new procs.  * test-repl.scm:  Updated.  * token-readers.c
	(scm_read_symbol):  Bail out on numbers.   (scm_read_number):
	Expect hexadecimal digits.   (scm_read_keyword):  Call
	`scm_read_symbol' instead of SCM_READER.
	(scm_read_extended_symbol):  New function.
	(scm_token_reader_lookup):  New function.   (scm_reader_misc_specs):
	New variable.  * token-readers.h:  Slightly updated.  *
	extract-token-readers.sh:  New (unused) file.  git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-4

2005-08-19  Ludovic Court`es <ludovic.courtes@laas.fr>

	* AUTHORS, COPYING, ChangeLog, Makefile, Makefile.am, NEWS,
	configure.ac, reader.c, reader.h, reader.scm, test-repl.scm,
	token-readers.c, token-readers.h: Allowed to build readers from
	reader; modularized out the `#' reader.  Warning:  This is somewhat
	broken, in particular lookup of existing token readers from
	`scm_standard_*reader_specs'.  * configure.ac:  New file.  *
	Makefile.am:  New file.  * reader.c (scm_c_make_reader):  Handle
	calls to `scm_reader_t' C   functions (SCM_TOKEN_READER_READER); use
	the new   `scm_token_reader_type_t' enum.   (default-reader):  New
	function.   (dynr_init_bindings):  Call `scm_load_standard_reader
	()'.  * reader.h (scm_token_reader_type_t):  New enum.
	(scm_token_reader_spec_t):  Use that.  * token-readers.c
	(scm_standard_sharp_reader):  New specs.   (scm_read_sharp):
	Splitted in several readers.   (scm_reader_standard_specs):  Now
	depends on   `scm_standard_sharp_reader'.
	(scm_read_skribe_literal):  Renamed to `scm_read_skribe_exp'.  *
	reader.scm (dynamic-link):  Appended the `.so' extension.  *
	COPYING, AUTHORS, NEWS, ChangeLog:  New (dummy) files.
	git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-3

2005-06-28  Ludovic Court`es <ludovic.courtes@laas.fr>

	* reader.c: Now allows to pass Scheme reader specifications to
	`make-reader'.  * reader.c (scm_c_make_reader):  Added generation of
	code that allows   to call token readers written as Scheme
	procedures.   (dynr_make_reader):  Renamed to `scm_make_reader'.
	(token_spec_to_string):  New function.   (do_scm_make_char):  New
	function.   (read_token_spec):  New function.
	(read_token_reader_spec):  New function.   (scm_to_reader_spec):
	Use the above functions.  git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-2

2005-06-27  Ludovic Court`es <ludovic.courtes@laas.fr>

	* reader.c, reader.h, test-repl.scm: Starting exporting
	`scm_c_make_reader ()' to Scheme.  * reader.c (CHECK_CODE_SIZE):
	Increased the threshold.   (scm_c_make_reader):  Added
	`CHECK_CODE_SIZE ()' invocations.   If no reader was specified for a
	given char, call `scm_ungetc ()'.   (scm_token_reader_lookup):  New
	function.   (scm_to_reader_spec):  New function.   (make-reader):
	Use `scm_to_reader_spec ()'.   (scm_reader_type):  New SMOB type.  *
	reader.h (scm_reader_spec_t):  New type.  * test-repl.scm:  Use the
	new API of `make-reader'.  git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--patch-1

2005-06-24  Ludovic Court`es <ludovic.courtes@laas.fr>

	* Initial import of a JIT-compiled, extensible, Scheme reader
	definition mechanism.  Initial import.   git-archimport-id:
	lcourtes@laas.fr--2004-libre/scheme-reader--devo--0.1--base-0

